<!-- Presentación -->
<section id="presentacion" class="bg-gradient-to-r from-purple-100 to-purple-50 py-10 px-4 md:px-8">
  <div class="max-w-6xl mx-auto bg-white border-4 border-purple-500 rounded-2xl overflow-hidden shadow-xl">
    <iframe src="https://docs.google.com/presentation/d/e/2PACX-1vSQqyhurcEOPf-ZCVEyQLlCxn3_J0mq5I0ElTmvzCBN74BBM9dgJMvmzQ_2X7wZ8Bzjm8ZAypBuH1z3/embed?start=false&loop=false&delayms=3000" frameborder="0" width="100%" height="600" allowfullscreen="true"></iframe>
  </div>
</section>

<!-- Encabezado con logo Finmobil SVG -->
<header class="flex flex-col items-center py-6">
  <svg width="200" height="200" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="grad-header" x1="0" y1="0" x2="1" y2="1">
        <stop offset="0%" stop-color="#3b82f6" />
        <stop offset="100%" stop-color="#a855f7" />
      </linearGradient>
    </defs>
    <rect x="20" y="60" width="20" height="20" rx="5" fill="url(#grad-header)" />
    <rect x="50" y="30" width="20" height="50" rx="5" fill="url(#grad-header)" />
  </svg>
  <h1 class="text-3xl font-bold text-purple-800 mt-4">Finmobil</h1>
</header>

<!-- Calculadora estilo inspirado en el logo -->
<section id="calculadora" class="bg-[#f5f0ff] py-12 px-4 md:px-8">
  <div class="max-w-md mx-auto bg-white border border-purple-300 rounded-3xl shadow-xl p-6 sm:p-8">
    <h2 class="text-2xl sm:text-3xl font-bold text-center text-purple-700 mb-4">Calculadora Finmobil</h2>
    <p class="text-center text-sm text-purple-600 mb-6">Calcula cuánto debes invertir para recibir un ingreso mensual pasivo según la tasa de retorno.</p>

    <form id="calc2" class="space-y-6">
      <div>
        <label for="flujo2" class="block text-sm font-medium text-purple-800 mb-1">Flujo mensual deseado</label>
        <input type="text" id="flujo2" placeholder="Ej: 5.000" class="w-full p-4 bg-purple-50 text-purple-900 border border-purple-300 rounded-lg text-xl font-semibold tracking-wide focus:outline-none focus:ring-2 focus:ring-purple-400" required>
        <p class="text-xs text-purple-600 mt-1">Monto que deseas recibir cada mes.</p>
      </div>
      <div>
        <label for="tasa2" class="block text-sm font-medium text-purple-800 mb-1">Tasa mensual (%)</label>
        <input type="number" step="any" id="tasa2" placeholder="Ej: 1.8" class="w-full p-4 bg-purple-50 text-purple-900 border border-purple-300 rounded-lg text-xl font-semibold tracking-wide focus:outline-none focus:ring-2 focus:ring-purple-400" required>
        <p class="text-xs text-purple-600 mt-1">Tasa mensual estimada de retorno.</p>
      </div>
      <button type="submit" class="w-full bg-purple-600 text-white font-bold py-3 rounded-lg hover:bg-purple-700 transition">Calcular</button>

      <div id="resultado-box" class="hidden mt-6 p-6 bg-purple-100 text-purple-900 border border-purple-400 rounded-lg shadow text-center animate-fade-in">
        <div class="text-4xl font-extrabold mb-2 flex justify-center items-center gap-2">
          <span id="resultado2">-</span>
        </div>
        <p class="mb-4">Este es el monto que necesitas invertir.</p>
        <div class="flex justify-center flex-wrap gap-4">
          <button type="button" onclick="enviarWhatsapp('resultado2')" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">WhatsApp</button>
          <button type="button" onclick="enviarEmail('resultado2')" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Email</button>
          <button type="button" onclick="capturarResultado()" class="bg-yellow-400 text-black px-4 py-2 rounded hover:bg-yellow-300">Guardar imagen</button>
        </div>
      </div>
    </form>
  </div>
</section>

<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
<script>
function formatNumber(num) {
  return num.toLocaleString('es-CO', { maximumFractionDigits: 0 });
}
function formatInput(input) {
  let value = input.value.replace(/\D/g, '');
  input.value = parseInt(value || 0).toLocaleString('es-CO');
}
const flujoInput = document.getElementById('flujo2');
flujoInput.addEventListener('input', () => formatInput(flujoInput));
const calc2 = document.getElementById('calc2');
calc2.addEventListener('submit', function (e) {
  e.preventDefault();
  const flujo = parseFloat(flujoInput.value.replaceAll('.', ''));
  const tasa = parseFloat(document.getElementById('tasa2').value) / 100;
  if (tasa === 0) return alert("La tasa debe ser mayor a 0%");
  const resultado = flujo / tasa;
  const resultadoFormateado = '$' + formatNumber(Math.round(resultado));
  document.getElementById('resultado2').textContent = resultadoFormateado;
  document.getElementById('resultado-box').classList.remove('hidden');
});
function enviarWhatsapp(resultadoId) {
  const resultado = document.getElementById(resultadoId).textContent;
  const mensaje = encodeURIComponent(`Resultado de mi cálculo: debo invertir ${resultado}`);
  window.open(`https://wa.me/529999100450?text=${mensaje}`, '_blank');
}
function enviarEmail(resultadoId) {
  const resultado = document.getElementById(resultadoId).textContent;
  const asunto = encodeURIComponent("Resultado calculadora Finmobil");
  const cuerpo = encodeURIComponent(`Resultado de mi cálculo: debo invertir ${resultado}`);
  window.location.href = `mailto:bitsapiens1@gmail.com?subject=${asunto}&body=${cuerpo}`;
}
function capturarResultado() {
  const box = document.getElementById('resultado-box');
  html2canvas(box).then(canvas => {
    const imageWithHeader = document.createElement('canvas');
    const ctx = imageWithHeader.getContext('2d');
    const padding = 60;
    imageWithHeader.width = canvas.width;
    imageWithHeader.height = canvas.height + padding + 40;
    ctx.fillStyle = '#f5f0ff';
    ctx.fillRect(0, 0, imageWithHeader.width, imageWithHeader.height);
    const logo = new Image();
    logo.src = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 100 100"><defs><linearGradient id="grad" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="%233b82f6"/><stop offset="100%" stop-color="%23a855f7"/></linearGradient></defs><rect x="10" y="60" width="20" height="20" rx="5" fill="url(%23grad)"/><rect x="40" y="30" width="20" height="50" rx="5" fill="url(%23grad)"/></svg>';
    logo.onload = function () {
      ctx.drawImage(logo, 20, 10, 40, 40);
      ctx.fillStyle = '#4c1d95';
      ctx.font = 'bold 20px sans-serif';
      ctx.fillText('Finmobil', 70, 40);
      ctx.drawImage(canvas, 0, padding);
      const link = document.createElement('a');
      link.download = 'resultado-finmobil.png';
      link.href = imageWithHeader.toDataURL();
      link.click();
    }
  });
}
</script>
<style>
@keyframes fade-in {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}
.animate-fade-in {
  animation: fade-in 0.5s ease-out forwards;
}
</style>
